// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.

import "inspectable.idl";

namespace DevHome.QuietBackgroundProcesses
{
    // Performance Engine types
    enum ProcessType
    {
        Unknown,
        User,
        System,
        Developer,
        Background,
    };

    [default_interface]
    runtimeclass ProcessRow
    {
        Int64 Pid { get; };
        String Name { get; };
        String PackageFullName { get; };
        String Aumid { get; };
        ProcessType Type { get; };

        UInt64 SampleCount { get; };
        Single PercentCumulative { get; };
        Single VarianceCumulative { get; };
        Single Sigma4Cumulative { get; };
        Single MaxPercent { get; };
        UInt32 SamplesAboveThreshold { get; };

        UInt64 TotalCpuTimeInMicroseconds { get; };
    }

    [default_interface]
    runtimeclass ProcessPerformanceTable
    {
        ProcessRow[] Rows { get; };
    }

    [default_interface]
    runtimeclass PerformanceRecorderEngine
    {
        PerformanceRecorderEngine();
        void Start(Int32 periodInMs);
        ProcessPerformanceTable Stop();
    }

    // Quiet Background Process types
    [default_interface]
    runtimeclass QuietBackgroundProcessesSession
    {
        static QuietBackgroundProcessesSession GetSingleton();
        Int64 Start();
        ProcessPerformanceTable Stop();
        Boolean IsActive { get; };
        Int64 TimeLeftInSeconds { get; };
    }

    [default_interface]
    runtimeclass QuietBackgroundProcessesSessionManager {
        QuietBackgroundProcessesSessionManager();
        static Boolean IsFeaturePresent();
        static QuietBackgroundProcessesSession GetSession();
        static QuietBackgroundProcessesSession TryGetSession();
    }
}
